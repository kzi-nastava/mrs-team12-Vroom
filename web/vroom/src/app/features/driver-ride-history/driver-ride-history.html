<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver Ride History</title>
</head>
<body>
    <div class="container">
        <h1>Driver's Ride History</h1>

        <div class="filter-controls">

            <div class="filter-item">
                <label for="startDate">Start Date</label>
                <input 
                    type="date" 
                    id="startDate"
                    [(ngModel)]="startDateFilter" 
                    (change)="onFilterChange()"
                    class="date-input"
                />
            </div>

            <div class="filter-item">
                <label for="endDate">End Date</label>
                <input 
                    type="date" 
                    id="endDate"
                    [(ngModel)]="endDateFilter" 
                    (change)="onFilterChange()"
                    class="date-input"
                />
            </div>

            <div class="filter-item">
                <label for="sortBy">Sort By</label>
                <select 
                    id="sortBy" 
                    [(ngModel)]="currentSort" 
                    (change)="onSortChange($event)"
                    class="sort-select"
                >
                    <option value="startTime,desc">Date: Newest First</option>
                    <option value="startTime,asc">Date: Oldest First</option>
                    <option value="price,desc">Price: High to Low</option>
                    <option value="price,asc">Price: Low to High</option>
                </select>

            </div>
                <button 
                    *ngIf="startDateFilter || endDateFilter" 
                    (click)="clearFilters()"
                    class="clear-filters-btn">
                        Clear Filters
                </button>
        </div>



        <div *ngIf="isLoading" class="loading-indicator">
            Loading ride history...
        </div>

        <div *ngFor="let ride of rides" class="ride-card">
            <div class="route">
                <span class="location">{{ ride.startAddress }}</span>
                <span class="arrow">→</span>
                <span class="location">{{ ride.endAddress }}</span>
            </div>
            <div class="details">
                <div class="detail-item">
                    <span class="detail-label">Date & Time</span>
                    <span class="detail-value">{{ ride.startTime.getDate() }} • {{ ride.startTime.getTime() }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Price</span>
                    <span class="detail-value">{{ ride.price }} RSD</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Status</span>
                    <span class="status-badge" [ngClass]="getStatusClass(ride.status)">{{ getStatusLabel(ride.status) }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Safety</span>
                    <span class="status-badge" [ngClass]="ride.panicActivated ? 'panic' : 'safe'">
                        {{ ride.panicActivated ? 'Panic' : 'Safe' }}
                    </span>
                </div>
            </div>
            
        </div>

    </div>
</body>