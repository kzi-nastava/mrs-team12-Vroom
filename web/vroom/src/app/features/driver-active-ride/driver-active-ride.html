<section class="ride-card" *ngFor="let ride of rides$ | async; else noRide">
  <div class="ride-card-header">
    <h2>Active Ride</h2>
    <span class="status-badge">{{ ride.status }}</span>
    
    <span *ngIf="ride.isScheduled && ride.scheduledTime" class="scheduled-badge priority">
      ðŸ“… Scheduled: {{ ride.scheduledTime | date:'dd.MM.yyyy HH:mm' }}
    </span>
   
    <span *ngIf="!ride.isScheduled" class="immediate-badge">
      âš¡ Now
    </span>
  </div>

  <div class="ride-card-body">
    <div class="info-row">
      <span class="label">Route</span>
      <span class="value">{{ ride.route.startAddress }} â†’ {{ ride.route.endAddress }}</span>
    </div>


    <div class="info-row" *ngIf="ride.startTime">
      <span class="label">Start time</span>
      <span class="value">{{ ride.startTime | date:'HH:mm' }}</span>
    </div>

    <div class="info-row">
      <span class="label">Price</span>
      <span class="value">{{ ride.price || 0 }} $</span>
    </div>

    <div class="info-row" *ngIf="ride.passengers?.length !== undefined">
      <span class="label">Passengers</span>
      <span class="value">{{ (ride.passengers?.length || 0) }}</span>
    </div>

    <div class="info-row" *ngIf="ride.vehicle">
      <span class="label">Vehicle</span>
      <span class="value">
        {{ ride.vehicle.brand }} {{ ride.vehicle.model }} ({{ ride.vehicle.licenceNumber }})
      </span>
    </div>

    <div class="passenger-list" *ngIf="ride.passengers?.length">
      <p class="label">Passenger names</p>
      <ul>
        <li *ngFor="let p of ride.passengers">{{ p }}</li>
      </ul>
    </div>
  </div>

  <div class="ride-card-footer">
    <button class="secondary" (click)="startRide(ride.rideID)">
      {{ ride.isScheduled ? 'Start scheduled ride' : 'Start ride' }}
    </button>
    <app-cancel-ride [rideId]="ride.rideID.toString()"></app-cancel-ride>
  </div>
</section>

<ng-template #noRide>
  <section class="ride-card empty">
    <p>No active rides.</p>
  </section>
</ng-template>